- id: '1758434770896'
  alias: Flic Button
  description: ''
  triggers:
  - trigger: webhook
    allowed_methods:
    - POST
    - PUT
    local_only: true
    webhook_id: Flic_Single
    alias: 'Flic single '
    id: Flic_Single Trigger
  - trigger: webhook
    allowed_methods:
    - POST
    - PUT
    local_only: true
    webhook_id: Flic_Double
    id: Flic_Double Trigger
    alias: 'Flic double '
  - trigger: webhook
    allowed_methods:
    - POST
    - PUT
    local_only: true
    webhook_id: Flic_Hold
    id: Flic_Hold Trigger
    alias: Flic hold
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Flic_Single Trigger
      sequence:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.main_lights
    - conditions:
      - condition: trigger
        id:
        - Flic_Double Trigger
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.new_scene
    - conditions:
      - condition: trigger
        id:
        - Flic_Hold Trigger
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.all_off
  mode: single
- id: '1758494538482'
  alias: Bedroom Ceiling Lights on -> bedroom lamp on
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.bedroom_ceiling_lights
    to: 'on'
  conditions: []
  actions:
  - action: scene.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: scene.full_lamp
  mode: single
- id: '1758599987280'
  alias: Workday Wake-up / 1am Goodnight
  description: ''
  triggers:
  - trigger: time
    at: 08:40:00
    id: 8:40am Time Trigger
  - trigger: time
    at: 09:00:00
    id: 9am
  - trigger: time
    at: 09:29:00
    id: '9:29'
  - trigger: time
    at: 01:00:00
    id: 1am goodnight
  - trigger: state
    entity_id:
    - binary_sensor.front_door
    to: 'on'
    id: Door
  - device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: long_press
    subtype: 1
    unique_id: cdb2dfb8-edb8-4c9a-83ef-5519e2338c0a
    trigger: device
    id: '1 Long press '
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - '1 Long press '
      - condition: and
        conditions:
        - condition: state
          state: 'on'
          entity_id: input_boolean.workday_today_toggle
        - condition: time
          after: 08:00:00
          before: 09:30:00
      sequence:
      - sequence:
        - action: light.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: light.bathroom_light
        - action: light.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: light.closet_light
        - action: input_boolean.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: input_boolean.im_awake_toggle_helper
    - conditions:
      - condition: trigger
        id:
        - 8:40am Time Trigger
      - condition: state
        entity_id: input_boolean.im_awake_toggle_helper
        state: 'off'
      - condition: and
        conditions:
        - condition: state
          state: 'on'
          entity_id: input_boolean.workday_today_toggle
        - condition: time
          after: 08:00:00
          before: 09:30:00
      sequence:
      - sequence:
        - event: hue_event
          event_data:
            device_id: 6e3f05f16e73548265ce22e622f4a268
            type: long_press
            subtype: 1
    - conditions:
      - condition: trigger
        id:
        - 9am
      - condition: and
        conditions:
        - condition: state
          state: 'on'
          entity_id: input_boolean.workday_today_toggle
        - condition: time
          after: 08:00:00
          before: 09:30:00
      - condition: template
        value_template: "{% set s = states.binary_sensor.front_door %} {{ s.state
          in ['unavailable', 'unknown']\n   or (as_timestamp(now()) - as_timestamp(s.last_changed))
          > 3600 }}\n"
      sequence:
      - action: media_player.volume_set
        metadata: {}
        data:
          volume_level: 0.3
        target:
          entity_id: media_player.blake_s_echo_pop
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.alexa_helper
        enabled: false
      - action: media_player.media_play
        target:
          entity_id: media_player.everywhere
        data: {}
    - conditions:
      - condition: trigger
        id:
        - '9:29'
        - Door
      - condition: and
        conditions:
        - condition: state
          state: 'on'
          entity_id: input_boolean.workday_today_toggle
        - condition: time
          after: 08:00:00
          before: 09:30:00
      sequence:
      - action: media_player.media_pause
        metadata: {}
        data: {}
        target:
          entity_id: media_player.everywhere
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.all_off
      - action: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.alexa_helper
      - action: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.im_awake_toggle_helper
      - action: media_player.volume_set
        metadata: {}
        data:
          volume_level: 0.45
        target:
          entity_id:
          - media_player.blake_s_echo_pop
    - conditions:
      - condition: trigger
        id:
        - 1am goodnight
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.goodnight_scene
  mode: parallel
- id: '1758990657332'
  alias: Living Room Lamp
  description: Control the living room lamp around sunset/sunrise and in sync with
    the main lights.
  triggers:
  - trigger: sun
    event: sunset
    offset: -01:00:00
    id: Sunset -1hr
    enabled: true
  - trigger: sun
    event: sunrise
    offset: 00:30:00
    id: Sunrise +30min
  - trigger: state
    entity_id:
    - light.main_lights
    to: 'on'
    id: Main lights on
  - trigger: state
    entity_id:
    - light.main_lights
    to: 'off'
    id: Main lights off
  - type: value
    device_id: c01df91d71e0dd72fe7a5636aea2d71b
    entity_id: 43e53695c8962aaa2bf07e8ed7325df8
    domain: sensor
    trigger: device
    above: 40
    for:
      hours: 0
      minutes: 5
      seconds: 0
    id: Cloud coverage >40
  - type: value
    device_id: c01df91d71e0dd72fe7a5636aea2d71b
    entity_id: 43e53695c8962aaa2bf07e8ed7325df8
    domain: sensor
    trigger: device
    below: 30
    for:
      hours: 0
      minutes: 5
      seconds: 0
    id: Cloud coverage <30
  - trigger: time
    at: '10:05:00'
    id: 10:05am Trigger
  - trigger: time
    at: '17:05:00'
    id: 5:05 pm
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Sunset -1hr
      sequence:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.living_room_lamp
      alias: Sunset - lamp on
    - conditions:
      - condition: trigger
        id:
        - Cloud coverage >40
        - 5:05 pm
      - condition: state
        entity_id: light.main_lights
        state: 'off'
      - type: is_value
        condition: device
        device_id: c01df91d71e0dd72fe7a5636aea2d71b
        entity_id: 43e53695c8962aaa2bf07e8ed7325df8
        domain: sensor
        above: 39
      - condition: or
        conditions:
        - condition: state
          state: 'off'
          entity_id: input_boolean.workday_today_toggle
        - condition: and
          conditions:
          - condition: state
            entity_id: input_boolean.workday_today_toggle
            state: 'on'
          - condition: time
            after: '17:00:00'
            before: '10:00:00'
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_pct: 75
          transition: 0
        target:
          entity_id: light.living_room_lamp
      alias: Cloud coverage >40%(work or 5:05) - lamp on
    - conditions:
      - condition: and
        conditions:
        - condition: trigger
          id:
          - Main lights off
        - condition: or
          conditions:
          - condition: sun
            before: sunrise
            after: sunset
            after_offset: -01:00:00
            before_offset: 00:30:00
          - condition: and
            conditions:
            - type: is_value
              condition: device
              device_id: c01df91d71e0dd72fe7a5636aea2d71b
              entity_id: 43e53695c8962aaa2bf07e8ed7325df8
              domain: sensor
              above: 40
            - condition: or
              conditions:
              - condition: state
                state: 'off'
                entity_id: input_boolean.workday_today_toggle
              - condition: and
                conditions:
                - condition: state
                  state: 'on'
                  entity_id: input_boolean.workday_today_toggle
                - condition: time
                  after: '17:00:00'
                  before: '10:00:00'
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_pct: 75
          transition: 0
        target:
          entity_id: light.living_room_lamp
      alias: 'Main lights off & (night time or >30% cloud coverage) - lamp on '
    - conditions:
      - condition: trigger
        id:
        - Sunrise +30min
      - type: is_value
        condition: device
        device_id: c01df91d71e0dd72fe7a5636aea2d71b
        entity_id: 43e53695c8962aaa2bf07e8ed7325df8
        domain: sensor
        below: 30
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.living_room_lamp
      alias: Sunrise & <30% cloud coverage - lamp off
    - conditions:
      - condition: trigger
        id:
        - Cloud coverage <30
      - condition: not
        conditions:
        - condition: sun
          before: sunrise
          after: sunset
          before_offset: 00:30:00
          after_offset: -01:00:00
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.living_room_lamp
      alias: Cloud coverage <30% - lamp off
    - conditions:
      - condition: trigger
        id:
        - Main lights on
      - condition: or
        conditions:
        - type: is_value
          condition: device
          device_id: c01df91d71e0dd72fe7a5636aea2d71b
          entity_id: 43e53695c8962aaa2bf07e8ed7325df8
          domain: sensor
          below: 30
        - condition: not
          conditions:
          - condition: sun
            before: sunrise
            after: sunset
            before_offset: 00:30:00
            after_offset: -01:00:00
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.living_room_lamp
      alias: Main lights turn on - lamp off
    - conditions:
      - condition: trigger
        id:
        - 10:05am Trigger
      - condition: state
        state: 'on'
        entity_id: input_boolean.workday_today_toggle
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.living_room_lamp
  mode: single
- id: nightly_github_sync
  alias: Nightly GitHub sync
  description: Run snapshots + push every night at 2 AM
  triggers:
  - trigger: time
    at: 02:00:00
  actions:
  - action: script.create_push_ha_info_to_github
    data: {}
  mode: single
- id: '1759452792193'
  alias: Bedroom Ceiling Lights (3) -> Set My Room
  description: ''
  use_blueprint:
    path: Custom/Toggle_blueprint.yaml
    input:
      source_entity: light.bedroom_ceiling_lights
      scene_target: scene.set_my_room
- id: '1759463858553'
  alias: Hue Dimmer Switch
  description: ''
  triggers:
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: short_release
    subtype: 1
    id: top_short
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: long_press
    subtype: 1
    id: top_long
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: short_release
    subtype: 2
    id: up_short
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: repeat
    subtype: 2
    id: up_repeat
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: long_press
    subtype: 2
    id: up_long
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: short_release
    subtype: 3
    id: down_short
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: repeat
    subtype: 3
    id: down_repeat
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: long_press
    subtype: 3
    id: down_long
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: short_release
    subtype: 4
    id: bottom_short
  - trigger: device
    device_id: 6e3f05f16e73548265ce22e622f4a268
    domain: hue
    type: long_press
    subtype: 4
    id: bottom_long
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: top_short
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.set_my_room
    - conditions:
      - condition: trigger
        id: top_long
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.im_awake
    - conditions:
      - condition: trigger
        id: up_short
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.full_lamp
    - conditions:
      - condition: trigger
        id: up_repeat
      sequence: []
    - conditions:
      - condition: trigger
        id: up_long
      sequence:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id:
          - light.closet_light
    - conditions:
      - condition: trigger
        id: down_short
      sequence:
      - action: fan.toggle
        metadata: {}
        data: {}
        target:
          entity_id: fan.bedroom_ceiling_fan
    - conditions:
      - condition: trigger
        id: down_repeat
      sequence: []
    - conditions:
      - condition: trigger
        id: down_long
      sequence: []
    - conditions:
      - condition: trigger
        id: bottom_short
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.lights_off
    - conditions:
      - condition: trigger
        id: bottom_long
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.goodnight_scene
  mode: parallel
  max: 10
- id: '1759721039676'
  alias: 'Work Schedule Automations '
  description: ''
  triggers:
  - trigger: time
    at: '13:00:00'
    id: 1pm
  - trigger: time
    at: '23:00:00'
    id: 11pm
  - trigger: time
    at: 02:00:00
    id: 2am
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 1pm
      sequence:
      - if:
        - condition: state
          state: 'on'
          entity_id: binary_sensor.workday_tomorrow_template_sensor
        then:
        - action: input_boolean.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: input_boolean.workday_tomorrow_toggle
        else:
        - action: input_boolean.turn_off
          metadata: {}
          data: {}
          target:
            entity_id: input_boolean.workday_tomorrow_toggle
    - conditions:
      - condition: trigger
        id:
        - 11pm
      sequence:
      - if:
        - condition: state
          state: 'on'
          entity_id: input_boolean.workday_tomorrow_toggle
        then:
        - action: notify.blake_foster30_gmail_com
          metadata: {}
          data:
            message: Work Alarm ON
            title: Work Alarm ON
            target: blake.foster30@gmail.com
        else:
        - action: notify.blake_foster30_gmail_com
          metadata: {}
          data:
            message: Work Alarm OFF
            title: Work Alarm OFF
            target: blake.foster30@gmail.com
    - conditions:
      - condition: trigger
        id:
        - 2am
      sequence:
      - if:
        - condition: state
          state: 'on'
          entity_id: input_boolean.workday_tomorrow_toggle
        then:
        - action: input_boolean.turn_on
          metadata: {}
          data: {}
          target:
            entity_id:
            - input_boolean.workday_today_toggle
        else:
        - action: input_boolean.turn_off
          metadata: {}
          data: {}
          target:
            entity_id:
            - input_boolean.workday_today_toggle
  mode: single
- id: '1759838752481'
  alias: Closet light -> bathroom light
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.closet_light
    to: 'on'
    id: Closet light on
  - trigger: state
    entity_id:
    - light.closet_light
    to: 'off'
    id: Closet light off
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Closet light on
      - condition: state
        entity_id: light.bathroom_light
        state: 'off'
      sequence:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bathroom_light
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.workday_toggle_helper
      - delay:
          hours: 0
          minutes: 30
          seconds: 0
          milliseconds: 0
      - action: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.workday_toggle_helper
    - conditions:
      - condition: trigger
        id:
        - Closet light off
      - condition: state
        entity_id: input_boolean.workday_toggle_helper
        state: 'on'
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.bathroom_light
      - action: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.workday_toggle_helper
  mode: restart
- id: '1760424497591'
  alias: Thermostat
  description: ''
  triggers:
  - trigger: time
    at: 09:00:00
    id: 9am
  - trigger: time
    at: '16:00:00'
    id: 4pm
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 9am
      sequence:
      - if:
        - condition: state
          entity_id: input_boolean.workday_today_toggle
          state: 'on'
        then:
        - action: scene.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: scene.thermostat_away
        else:
        - action: scene.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: scene.thermostat_ideal_morning
    - conditions:
      - condition: trigger
        id:
        - 4pm
      sequence:
      - action: scene.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: scene.thermostat_ideal
  mode: single
- id: '1760842208486'
  alias: Workday Door plus motion
  description: ''
  triggers:
  - entity_id: binary_sensor.front_door
    to: 'on'
    trigger: state
  conditions:
  - condition: state
    entity_id: input_boolean.workday_today_toggle
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: time
        before: 08:00:00
        after: 05:00:00
      sequence:
      - if:
        - condition: template
          value_template: "{% set motion_state = states('input_datetime.last_motion_on')
            %} {% if motion_state in ['unknown', 'unavailable', ''] %}\n  {{ false
            }}\n{% else %}\n  {% set door_ts = as_timestamp(trigger.to_state.last_changed)
            %}\n  {% set motion_ts = as_timestamp(motion_state) %}\n  {{ 1 <= (door_ts
            - motion_ts) <= 900 }}\n{% endif %}\n"
        then:
        - action: scene.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: scene.all_off
        else:
        - action: scene.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: scene.new_scene
        - action: media_player.play_media
          metadata: {}
          data:
            media:
              media_content_id: '837'
              media_content_type: app
              metadata:
                title: YouTube
                thumbnail: http://192.168.1.68:8060/query/icon/837
                media_class: app
                children_media_class:
                navigateIds:
                - {}
                - media_content_type: apps
                  media_content_id: ''
                browse_entity_id: media_player.bedroom_tv
          target:
            entity_id: media_player.bedroom_tv
    - conditions:
      - condition: time
        after: '16:30:00'
        before: '19:00:00'
      sequence:
      - if:
        - condition: template
          value_template: "{% set motion_state = states('input_datetime.last_motion_on')
            %} {% if motion_state in ['unknown', 'unavailable', ''] %}\n  {{ false
            }}\n{% else %}\n  {% set door_ts = as_timestamp(trigger.to_state.last_changed)
            %}\n  {% set motion_ts = as_timestamp(motion_state) %}\n  {{ 1 <= (door_ts
            - motion_ts) <= 900 }}\n{% endif %}\n"
        then:
        - action: scene.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: scene.all_off
        else:
        - action: scene.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: scene.new_scene
        - action: media_player.play_media
          metadata: {}
          data:
            media:
              media_content_id: '837'
              media_content_type: app
              metadata:
                title: YouTube
                thumbnail: http://192.168.1.68:8060/query/icon/837
                media_class: app
                children_media_class:
                navigateIds:
                - {}
                - media_content_type: apps
                  media_content_id: ''
                browse_entity_id: media_player.bedroom_tv
          target:
            entity_id: media_player.bedroom_tv
  mode: single
- id: '1760855339342'
  alias: Stamp last motion ON time
  description: Update or clear helper when motion changes
  triggers:
  - entity_id: binary_sensor.motion_1_motion
    to: 'on'
    id: motion_on
    trigger: state
  - entity_id: binary_sensor.motion_1_motion
    to: 'off'
    id: motion_off
    trigger: state
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: motion_on
      sequence:
      - action: input_datetime.set_datetime
        metadata: {}
        data:
          datetime: '{{ now().isoformat() }}'
        target:
          entity_id: input_datetime.last_motion_on
    - conditions:
      - condition: trigger
        id: motion_off
      sequence:
      - action: input_datetime.set_datetime
        metadata: {}
        data:
          datetime: ''
        target:
          entity_id: input_datetime.last_motion_on
  mode: single
- id: '1761047102816'
  alias: Test Bay
  description: ''
  triggers:
  - trigger: event
    event_type: ''
  conditions: []
  actions:
  - action: media_player.volume_set
    metadata: {}
    data:
      volume_level: 0.3
    target:
      entity_id: media_player.blake_s_echo_pop
  - action: media_player.media_play
    target:
      entity_id: media_player.everywhere
    data: {}
  - action: media_player.media_pause
    metadata: {}
    data: {}
    target:
      entity_id:
      - media_player.everywhere
  mode: single
