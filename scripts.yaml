find_remote:
  sequence:
  - action: remote.send_command
    metadata: {}
    data:
      num_repeats: 1
      delay_secs: 0.4
      hold_secs: 0
      command: find_remote
    target:
      entity_id: remote.bedroom_tv
  alias: Find Remote
  description: ''
play_music_alexa:
  alias: Alarm Music
  sequence:
  - parallel:
    - alias: Music Off
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.disable_toggle
      - wait_for_trigger:
        - alias: Off Short
          trigger: event
          event_type: zha_event
          event_data:
            device_ieee: 00:17:88:01:02:18:b1:7a
            command: off_short_release
        - trigger: template
          value_template: "{{ is_state('binary_sensor.front_door', 'on') \n   and
            is_state('binary_sensor.motion_1_motion', 'on') \n   and as_timestamp(states.binary_sensor.motion_1_motion.last_changed)
            < as_timestamp(states.binary_sensor.front_door.last_changed) }}\n"
          alias: Door - Leaving Logic
        timeout:
          hours: 0
          minutes: 30
          seconds: 0
          milliseconds: 0
      - action: media_player.media_stop
        metadata: {}
        data: {}
        target:
          entity_id: media_player.everywhere
      - delay:
          hours: 0
          minutes: 0
          seconds: 30
          milliseconds: 0
      - action: media_player.volume_set
        metadata: {}
        data:
          volume_level: 0.3
        target:
          entity_id: media_player.everywhere
      - action: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.disable_toggle
    - sequence:
      - alias: Play Music
        sequence:
        - action: media_player.volume_set
          metadata: {}
          data:
            volume_level: 0.01
          target:
            entity_id: media_player.blake_s_echo_spot
        - delay:
            hours: 0
            minutes: 0
            seconds: 3
            milliseconds: 0
        - action: alexa_devices.send_text_command
          metadata: {}
          data:
            text_command: Shuffle Alex warren on everywhere group
            device_id: ba7e4aed08d0947fa03068f398842568
        - action: media_player.volume_set
          metadata: {}
          data:
            volume_level: 0
          target:
            entity_id: media_player.everywhere
        - delay:
            hours: 0
            minutes: 0
            seconds: 3
            milliseconds: 0
        - action: media_player.shuffle_set
          metadata: {}
          data:
            shuffle: true
          target:
            entity_id: media_player.everywhere
        - delay:
            hours: 0
            minutes: 0
            seconds: 7
            milliseconds: 0
        - action: media_player.media_next_track
          metadata: {}
          data: {}
          target:
            entity_id: media_player.everywhere
          enabled: true
        - delay:
            hours: 0
            minutes: 0
            seconds: 3
            milliseconds: 0
        - action: media_player.media_next_track
          metadata: {}
          data: {}
          target:
            entity_id: media_player.everywhere
          enabled: true
        - action: media_player.volume_set
          metadata: {}
          data:
            volume_level: 0.01
          target:
            entity_id: media_player.everywhere
      - alias: Volume Up
        repeat:
          count: 7
          sequence:
          - action: media_player.volume_set
            metadata: {}
            data:
              volume_level: '{{(repeat.index * 0.02) }}'
            target:
              entity_id: media_player.everywhere
          - delay:
              hours: 0
              minutes: 0
              seconds: 2
              milliseconds: 0
      - delay:
          hours: 0
          minutes: 0
          seconds: 10
          milliseconds: 0
      - action: light.turn_on
        metadata: {}
        data:
          transition: 15
        target:
          entity_id: light.bedroom_lamp
      - delay:
          hours: 0
          minutes: 0
          seconds: 10
          milliseconds: 0
      - action: fan.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: fan.bedroom_fan
      - delay:
          hours: 0
          minutes: 0
          seconds: 45
          milliseconds: 0
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_ceiling_lights
  description: ''
set_date_to_today:
  alias: Scheduled Off & Working Override dashboard script
  icon: mdi:calendar-today
  mode: parallel
  fields:
    target_entity:
      description: The input_datetime entity to set to today's date
      example: input_datetime.scheduled_off
  sequence:
  - action: input_datetime.set_datetime
    target:
      entity_id: '{{ target_entity }}'
    data:
      date: '{{ (now() - timedelta(days=1)).strftime(''%Y-%m-%d'') }}'
  description: ''
create_push_ha_info_to_github_newest:
  description: Generates HA_Overview.md, runs diagnostics, pushes to GitHub, AND creates
    a zip for download.
  mode: single
  sequence:
  - action: shell_command.write_ha_overview
    data:
      content: "# Home Assistant Configuration\n_Last Updated: {{ now().isoformat()
        }}_\n\n## \U0001F6E0 UI Helpers\nBelow are the input helpers configured in
        Home Assistant.\n\n{% set helpers = ['input_boolean', 'input_button', 'input_datetime',
        'input_number', 'input_select', 'input_text', 'counter', 'timer', 'schedule']
        %}\n{% for domain in helpers %}\n{% set assets = states[domain] | list %}\n{%
        if assets | count > 0 %}\n### {{ domain | replace('input_', '') | capitalize
        }}\n| Entity ID | Name | State | Attributes |\n|---|---|---|---|\n{% for s
        in assets | sort(attribute='entity_id') %}\n{% set details = [] %}\n{% if
        domain == 'input_number' %}\n  {% set details = details + ['min=' ~ s.attributes.min,
        'max=' ~ s.attributes.max, 'step=' ~ s.attributes.step] %}\n{% elif domain
        == 'input_select' %}\n  {% set details = details + ['options=' ~ s.attributes.options
        | join(', ')] %}\n{% elif domain == 'input_datetime' %}\n  {% set details
        = details + ['has_date=' ~ s.attributes.has_date, 'has_time=' ~ s.attributes.has_time]
        %}\n{% elif domain == 'timer' %}\n   {% set details = details + ['duration='
        ~ s.attributes.duration] %}\n{% elif domain == 'counter' %}\n   {% set details
        = details + ['min=' ~ s.attributes.min, 'max=' ~ s.attributes.max] %}\n{%
        endif %}\n| `{{ s.entity_id }}` | **{{ s.name | replace(\"'\", \"'\\\\''\")
        }}** | {{ s.state | replace(\"'\", \"'\\\\''\") }} | {{ details | join(',
        ') | replace(\"'\", \"'\\\\''\") }} |\n{% endfor %}\n\n{% endif %}\n{% endfor
        %}\n\n---\n\n## \U0001F3E0 All Entities (By Domain)\n{% for domain, items
        in states | groupby('domain') %}\n{% if domain not in helpers and domain !=
        'group' %}\n<details><summary><b>{{ domain | title }} ({{ items | length }})</b></summary>\n\n|
        Entity ID | Name | State |\n|---|---|---|\n{% for s in items | sort(attribute='entity_id')
        %}\n| `{{ s.entity_id }}` | {{ s.name | replace(\"'\", \"'\\\\''\") }} | {{
        s.state | replace(\"'\", \"'\\\\''\") }} |\n{% endfor %}\n</details>\n\n{%
        endif %}\n{% endfor %}\n"
  - action: shell_command.write_log_slice
  - action: shell_command.write_automation_runs
  - action: shell_command.write_error_log
  - action: shell_command.ha_git_commit_push
  - alias: Skip AI Zip file actions during daily commit
    if:
    - condition: template
      value_template: '{{ context.user_id is not none }}

        '
      alias: 'Triggered by dashboard button '
    then:
    - action: shell_command.prepare_ai_context_zip
    - action: notify.mobile_app_blakes_iphone
      data:
        title: Backup Complete
        message: GitHub updated & Zip ready. Tap to download.
        data:
          url: /local/ha_ai_context.zip
          clickAction: /local/ha_ai_context.zip
  alias: Push Ha Info to GitHub & Create AI Zip File
find_my_phone:
  alias: Find My Phone
  use_blueprint:
    path: ggoulart/Find My Apple Device.yaml
    input:
      apple_device: f2f0fd38cf7bfe7c575b14a75d8b8413
      apple_account: blake.foster30@gmail.com
  description: ''
temporary_thermostat_adjustment:
  alias: Temporary Thermostat Adjustment
  description: Sets the thermostat for a set duration and reverts. No helper required.
  icon: mdi:thermostat-clock
  mode: restart
  fields:
    hvac_mode:
      name: HVAC Mode
      selector:
        select:
          options:
          - label: Cool
            value: cool
          - label: Heat
            value: heat
      default:
        '[object Object]':
      required: true
    target_temp:
      name: Target Temperature
      selector:
        number:
          min: 60
          max: 85
          unit_of_measurement: °F
      default: 70
      required: true
    duration:
      name: Duration (Minutes)
      selector:
        number:
          min: 10
          max: 240
          step: 5
          unit_of_measurement: min
      default: 30
      required: true
  sequence:
  - action: scene.create
    metadata: {}
    data:
      scene_id: temp_thermostat_snapshot
      snapshot_entities:
      - climate.nest_thermostat
  - action: climate.set_temperature
    target:
      entity_id: climate.nest_thermostat
    data:
      hvac_mode: '{{ hvac_mode }}'
      temperature: '{{ target_temp }}'
  - delay:
      minutes: '{{ duration }}'
  - action: scene.turn_on
    target:
      entity_id: scene.temp_thermostat_snapshot
  - action: scene.delete
    metadata: {}
    target:
      entity_id: scene.temp_thermostat_snapshot
    data: {}
set_room_2:
  sequence:
  - action: scene.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: scene.lights_off_except_bedroom
  - action: light.turn_off
    metadata: {}
    target:
      entity_id: light.bedroom_ceiling_lights
    data: {}
  - action: scene.turn_on
    metadata: {}
    target:
      entity_id: scene.full_lamp
    data: {}
  - action: fan.turn_off
    metadata: {}
    target:
      entity_id: fan.bedroom_fan
    data: {}
  - if:
    - condition: state
      entity_id: media_player.bedroom_tv
      state:
      - playing
    then: []
    else:
    - action: media_player.play_media
      metadata: {}
      target:
        entity_id: media_player.bedroom_tv
      data:
        media:
          media_content_id: '837'
          media_content_type: app
          metadata:
            title: YouTube
            thumbnail: http://192.168.1.68:8060/query/icon/837
            media_class: app
            children_media_class:
            navigateIds:
            - {}
            - media_content_type: apps
              media_content_id: ''
            browse_entity_id: media_player.bedroom_tv
  mode: single
  alias: Set Room
  description: ''
temporary_thermostat_adjustment1:
  alias: Temporary Thermostat Adjustment
  description: Sets the thermostat for a set duration, with support for step adjustments.
  icon: mdi:thermostat-clock
  mode: restart
  fields:
    hvac_mode:
      name: HVAC Mode
      selector:
        select:
          options:
          - label: Cool
            value: cool
          - label: Heat
            value: heat
    target_temp:
      name: Target Temperature
      selector:
        number:
          min: 60
          max: 85
          unit_of_measurement: °F
    temp_step:
      name: Temp Step
      selector:
        number:
          min: -5
          max: 5
          step: 1
    duration:
      name: Duration (Minutes)
      selector:
        number:
          min: 10
          max: 240
          step: 5
          unit_of_measurement: min
      required: true
      default: 30
  sequence:
  - action: scene.create
    data:
      scene_id: temp_thermostat_snapshot
      snapshot_entities:
      - climate.nest_thermostat
  - action: climate.set_temperature
    target:
      entity_id: climate.nest_thermostat
    data:
      hvac_mode: '{{ hvac_mode if hvac_mode is defined and hvac_mode != none else
        states(''climate.nest_thermostat'') }}'
      temperature: "{% set current = state_attr('climate.nest_thermostat', 'temperature')
        | float(70) %} {% if temp_step is defined and temp_step != none %}\n  {{ (current
        + temp_step) | round(0) }}\n{% else %}\n  {{ target_temp | default(current)
        }}\n{% endif %}\n"
  - delay:
      minutes: '{{ duration | default(30) }}'
  - action: scene.turn_on
    target:
      entity_id: scene.temp_thermostat_snapshot
    data:
      transition: 1
revert_thermostat_adjustment:
  sequence:
  - action: scene.turn_on
    metadata: {}
    target:
      entity_id: scene.temp_thermostat_snapshot
    data: {}
  - action: script.turn_off
    metadata: {}
    target:
      entity_id: script.temporary_thermostat_adjustment
    data: {}
  - action: scene.delete
    metadata: {}
    target:
      entity_id: scene.temp_thermostat_snapshot
    data: {}
  alias: Revert Thermostat Adjustment
  description: ''
